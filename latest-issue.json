[{"body":"\nThis document addresses a common error encountered when working with Next.js API routes:  `Error: NextResponse is not defined`. This error arises when you attempt to use the `NextResponse` object within an API route without the correct import.  `NextResponse` is crucial for sending custom responses (e.g., setting headers, status codes, cookies) from your API routes.\n\n\n**Description of the Error:**\n\nThe `Error: NextResponse is not defined` error indicates that the JavaScript interpreter in your API route cannot find the `NextResponse` object. This usually happens because you haven't imported it correctly from the `next/server` module, which is specific to the API routes environment in Next.js 13 and later.\n\n\n**Code & Step-by-Step Fix:**\n\nLet's say you have an API route at `pages/api/hello.js` that's attempting to send a custom response:\n\n\n**Incorrect Code (Will produce the error):**\n\n```javascript\n// pages/api/hello.js\nexport default function handler(req, res) {\n  const response = new NextResponse('Hello, Next.js!'); // Incorrect: NextResponse is not defined here\n  res.status(200).json({ message: response });\n}\n```\n\n**Corrected Code:**\n\n```javascript\n// pages/api/hello.js\nimport { NextResponse } from 'next/server';\n\nexport default function handler(req, res) {\n  const response = new NextResponse('Hello, Next.js!'); //Correct: Now NextResponse is imported\n  return response; // Important: return NextResponse object\n}\n```\n\n**Explanation of Changes:**\n\n1. **Import `NextResponse`:** We added `import { NextResponse } from 'next/server';` at the top of the file. This line imports the necessary object from the correct Next.js module.  This is crucial for working with API routes in Next.js 13+.  Older versions use different methods.\n2. **Return `NextResponse`:**  Instead of using the `res` object (which is designed for older API routes), we now return the `NextResponse` object directly. This is how you send customized responses in the new API Routes architecture. Using `res` will cause problems and is deprecated.\n\n**Alternative Example with JSON Response:**\n\n```javascript\nimport { NextResponse } from 'next/server';\n\nexport default function handler(req, res) {\n  const data = { message: 'Hello, Next.js from JSON!' };\n  return NextResponse.json(data); //Use NextResponse.json for JSON responses\n}\n```\n\n**External References:**\n\n* **Next.js API Routes Documentation:** [https://nextjs.org/docs/api-routes/introduction](https://nextjs.org/docs/api-routes/introduction) (Check for your Next.js version's specific documentation)\n* **Next.js `NextResponse` API:**  (Look for the `NextResponse` section within the API routes documentation - the exact link depends on the Next.js version)\n\n\n**Important Note:**  The use of `res` object in the way shown in the initial incorrect code is incompatible with the `NextResponse` approach.  Attempting to mix them will lead to errors.  Always use `NextResponse` exclusively when building API routes in the new architecture.\n\n\n\nCopyrights (c) OpenRockets Open-source Network. Free to use, copy, share, edit or publish.\n","number":873,"title":"Handling `Error: NextResponse is not defined` in Next.js API Routes"}]
